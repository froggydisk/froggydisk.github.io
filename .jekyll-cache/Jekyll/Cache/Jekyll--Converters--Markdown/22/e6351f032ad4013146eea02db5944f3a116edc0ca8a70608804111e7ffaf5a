I"i
<h1 id="-ì—ëŸ¬">ğŸ“Œ ì—ëŸ¬</h1>
<p>ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ yaml íŒŒì¼ì„ ì‘ì„±í•  ë•Œ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ëŠ” íŒŒë“œë¥¼ ìƒì„±í•˜ë ¤ê³  í–ˆìœ¼ë‚˜ ì œëŒ€ë¡œ ìƒì„±ì´ ë˜ì§€ ì•Šê³  ê³„ì†í•´ì„œ <code class="language-plaintext highlighter-rouge">ImagePullBackOff</code> ìƒíƒœê°€ ë˜ì—ˆë‹¤. Kubernetes Dashboardë¥¼ í†µí•´ì„œ ë³´ë‹ˆ ë‹¤ìŒê³¼ ê°™ì€ <strong>401 Unauthorized</strong> ì—ëŸ¬ ë©”ì‹œì§€ê°€ ë– ìˆì—ˆë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Failed to pull image: rpc error: code = Unknown desc = failed to pull and unpack image: 
failed to resolve reference: pulling from host failed with status code [manifests latest]: 
401 Unauthorized
</code></pre></div></div>

<p>ì‚¬ì„¤ ì €ì¥ì†Œ(Private Registry)ì—ì„œ ì´ë¯¸ì§€ë¥¼ ë°›ì•„ì˜¬ ë•Œ secretì„ ì‚¬ìš©í•´ì„œ ì¸ì¦ì„ í•˜ê²Œ ë˜ëŠ”ë° ì•„ë¬´ë˜ë„ ì¸ì¦ì— ê³„ì† ì‹¤íŒ¨í•˜ê³  ìˆëŠ” ë“¯í•˜ë‹¤. ë¶„ëª… secretì„ ë“±ë¡í•´ ë‘ì—ˆëŠ”ë°ë„ ì—ëŸ¬ê°€ ì‚¬ë¼ì§€ì§€ ì•Šì•„ì„œ ì˜¤ëœì‹œê°„ ì‚½ì§ˆì„ í•˜ì˜€ë‹¤. Nginxë¥¼ í†µí•´ì„œ ë“¤ì–´ì˜¬ ë•Œë„ https í”„ë¡œí† ì½œë¡œ ë“¤ì–´ì˜¤ê³  ìˆìœ¼ë‹ˆ ì•„ë¬´ëŸ° ë¬¸ì œê°€ ì—†ëŠ”ë° ì´ìƒí–ˆë‹¤.</p>

<p>ê²°êµ­ êµ¬ê¸€ë§ì„ ê³„ì†í•œ ëì— ë‹¤ìŒê³¼ ê°™ì€ ê¸€ì„ ë°œê²¬í–ˆë‹¤.<br />
<strong><code class="language-plaintext highlighter-rouge">Secretsì˜ ê²½ìš° ê°™ì€ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ì¡´ì¬í•´ì•¼í•©ë‹ˆë‹¤.</code></strong> (<a href="https://velog.io/@numerok/harbor-ì‚¬ìš©-ì‹œ-unauthorized-unauthorized-to-access-repository">ì°¸ê³ </a>)</p>

<p>ì •ì‹ ì´ ë²ˆì© ë“¤ì—ˆë‹¤. ê°œë°œì—ëŠ” ê¼¼ê¼¼í•¨ì´ í•„ìˆ˜ë¼ëŠ” ê²ƒì„ ë‹¤ì‹œê¸ˆ ëŠë‚€ë‹¤.
ì•„ë˜ëŠ” secretì„ ë§Œë“œëŠ” ëª…ë ¹ì–´ì´ë‹¤. í•„ìëŠ” ì €ì¥ì†Œë¡œ Harborë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl create secret docker-registry harbor --docker-server=[ì €ì¥ì†Œì£¼ì†Œ] --docker-username=[ì €ì¥ì†ŒID] --docker-password=[ì €ì¥ì†Œë¹„ë°€ë²ˆí˜¸] --docker-email=[ì´ë©”ì¼] -n [ë„¤ì„ìŠ¤í˜ì´ìŠ¤]
</code></pre></div></div>
<p>ë§ˆì§€ë§‰ì— <code class="language-plaintext highlighter-rouge">-n [ë„¤ì„ìŠ¤í˜ì´ìŠ¤]</code>ê°€ ê°€ì¥ ì¤‘ìš”í•˜ë‹¤. ì´ëŠ” íŒŒë“œë¥¼ ìƒì„±í•˜ëŠ” ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì™€ ê°™ì•„ì•¼í•œë‹¤!</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># deployment.yaml
...
    template:
      metadata:
        labels:
          app: test            
      spec:
        imagePullSecrets: 
        - name: harbor
        containers:
          - name: test
            image: harbor.io/testImage:latest
...                        
</code></pre></div></div>
:ET